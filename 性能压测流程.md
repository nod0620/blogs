###性能压测


####测试什么
	1.本次测试需要测试什么，比如测试应用的极限tps，qps或其他性能指标，需要搞清楚测试目的，然后才能开始测试
	
	2.除了关注应用本身的指标，系统的指标是否需要关注，如果需要关注，需要关注的点是哪些？io，网络，cpu利用率，内存，load，其它？

####怎么测试
	1.确认测试目标后，需要进行前期的预估过程，预估的点很多，如qps，tps，存储量等，如果预估后发现对于应用某个方面来说不靠谱，有两种可能：预估本身不靠谱；应用某个方面支撑不了这个预估值，如果是前者需要重新预估，后者的话，挺悲惨的，需要换其他技术方案了
	
	2.选择测试的方法，如果是著名的开源应用，一般会有配套的测试套件，可以选择，如果是一般的开源应用或者自主开发，可以自己写测试代码进行测试(ab 也可以压测)
	
	3.测试方法确定后，需要搭建测试的环境，要求只有两个字：真实。测试环境和将来的线上环境要相似，一般来说单机应用测试环境和线上环境可以做到一致，分布式应用测试环境上规模远比线上应用的规模小，所以就需要考虑应用是不是线性扩展的，如果是非线性扩展的，需要确定当集群扩展后，相应的性能指标的增长情况，计算出一个增长模型
	
	4.测试数据必须和线上环境生产数据相似，如果能用拉下来的生产数据进行测试的话最佳
	
	5.压测时，首先需要注意client会不会成为瓶颈，如果client成为瓶颈，那么压测的指标没有意义，排除这个问题后，选择和线上环境差不多的并发量来进行测试，能得到比较准确的指标
	
	6.第5步中说到选择和线上环境差不多的并发量来进行测试，此外应该再进行比线上并发量小和并发量大的场景进行测试，这样的好处是了解应用在不同并发量情况下的表现，如果是自主开发的应用，说不定能找出性能的潜在优化点
	
	7.机器其他的关注点如：io，网络，cpu利用率，内存，load等也需要关注，即使是在应用的性能指标达到预期后，如果某些指标过高，也不认为应用上线后是稳定的，这点指标的阈值可以在测试前定下，随着应用的不同而不同
	
	8.测试的时间越长越好，一是可以测试稳定性，二是可以排除短时间内因为测试数据的倾斜造成的测试结果不准确，三是如果应用是某些语言写的，可以看到语言机制对应用的影响(如jvm的gc)
	

####测试步骤
	1.性能估算，确定测试目标
	2.确定机器，包括应用部署的机器和测试机器，应用部署机器尤其重要，最好和要上线的配置一致
	3.制造测试数据，有生产数据尤佳
	4.开始测试了，并发量从小到大进行压测，记录各种性能指标，记得排除client的性能瓶颈的影响
	5.第4步往往不顺利，经常会遇到性能低下的情况，这个时候需要找各种性能瓶颈；如果没有明显的性能瓶颈，可以将测试数据换掉，换成简单的测试数据，这样应该能跑出了理想中的性能，进行比较，会发现哪些点是瓶颈，抑或你的应用就是这种水平。。。
	6.进行长时间的测试，观察稳定性
	
	一般4，5两步会反复进行
	
	









	
	
	
	
	
	
	
	
	
	
